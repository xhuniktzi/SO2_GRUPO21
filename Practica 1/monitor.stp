#!/usr/bin/stap

probe begin {
    printf("Monitoring PIDs: %d, %d\n", $1, $2)
}

probe syscall.read {
    if (pid() == $1 || pid() == $2) {
        printf("Proceso %d: read (%s)\n", pid(), ctime(gettimeofday_s()))
    }
}

probe syscall.write {
    if (pid() == $1 || pid() == $2) {
        printf("Proceso %d: write (%s)\n", pid(), ctime(gettimeofday_s()))
    }
}

probe syscall.lseek {
    if (pid() == $1 || pid() == $2) {
        printf("Proceso %d: lseek (%s)\n", pid(), ctime(gettimeofday_s()))
    }
}

probe end {
    printf("End of monitoring for PIDs: %d, %d\n", $1, $2)
}
