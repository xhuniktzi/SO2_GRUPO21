#!/usr/bin/stap

global pid1, pid2

probe begin {
    printf("Monitoring PIDs: %d, %d\n", pid1, pid2)
}

probe syscall.read {
    if (pid() == pid1 || pid() == pid2) {
        printf("%d:read(%s)\n", pid(), ctime(gettimeofday_s()))
    }
}

probe syscall.write {
    if (pid() == pid1 || pid() == pid2) {
        printf("%d:write(%s)\n", pid(), ctime(gettimeofday_s()))
    }
}

probe syscall.lseek {
    if (pid() == pid1 || pid() == pid2) {
        printf("%d:lseek(%s)\n", pid(), ctime(gettimeofday_s()))
    }
}

probe end {
    printf("End of monitoring for PIDs: %d, %d\n", pid1, pid2)
}
